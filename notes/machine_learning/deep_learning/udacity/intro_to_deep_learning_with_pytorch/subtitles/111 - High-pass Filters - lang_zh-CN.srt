1
00:00:04,099 --> 00:00:10,379
在图像处理中 我们用过滤器来过滤掉图像中不需要或无关的信息

2
00:00:10,380 --> 00:00:16,234
也用过滤器来放大图像的某些特征 如物体边界或其它显著特征

3
00:00:16,234 --> 00:00:19,169
高通过滤器用于锐化图像

4
00:00:19,170 --> 00:00:22,545
以及强化图像的高频区域

5
00:00:22,545 --> 00:00:25,110
也就是相邻像素强度发生突变的区域

6
00:00:25,109 --> 00:00:30,399
比如从极暗过渡到极亮的那些像素区域

7
00:00:30,399 --> 00:00:33,375
由于我们要观察的是强度模式

8
00:00:33,375 --> 00:00:37,844
所以我们要用过滤器来处理灰度图像

9
00:00:37,844 --> 00:00:42,869
毕竟灰度图像会以简单的格式将明暗情况展示出来 从而体现强度信息

10
00:00:42,869 --> 00:00:46,724
以这张熊猫图为例 我们来深入探讨一下

11
00:00:46,725 --> 00:00:50,594
如果在这张图像上应用高通过滤器 你觉得会怎么样？

12
00:00:50,594 --> 00:00:55,319
原图那些强度没有变化或变化不大的区域

13
00:00:55,319 --> 00:00:57,975
比如这大片黑暗或明亮的区域

14
00:00:57,975 --> 00:01:02,399
会被高通过滤器过滤掉 而且像素颜色会变为黑色

15
00:01:02,399 --> 00:01:06,539
但在这些区域里 由于像素比邻近像素明亮许多

16
00:01:06,540 --> 00:01:10,550
所以高通过滤器会加强这一变化并形成一根线条

17
00:01:10,549 --> 00:01:14,325
正如你所见 结果就是把边缘强化了

18
00:01:14,325 --> 00:01:17,969
所谓边缘 就是指图像里强度发生突变的区域

19
00:01:17,969 --> 00:01:22,709
通常暗示着物体边界的存在

20
00:01:22,709 --> 00:01:26,444
我们来看这类过滤器的具体原理

21
00:01:26,444 --> 00:01:29,339
接下来我要讲的过滤器是以矩阵形式存在的

22
00:01:29,340 --> 00:01:32,385
通常称为卷积核

23
00:01:32,385 --> 00:01:36,150
其实就是一些值网格 能对图像进行修改

24
00:01:36,150 --> 00:01:40,109
以检测边缘的高通过滤器为例

25
00:01:40,109 --> 00:01:44,209
这是个三乘三的核 其元素总和为 0

26
00:01:44,209 --> 00:01:48,434
边缘检测时 所有元素总和为 0 是很重要的

27
00:01:48,435 --> 00:01:53,284
因为这类过滤器要计算的是相邻像素的差异 或者说变化

28
00:01:53,284 --> 00:01:58,185
要计算差异 就需要将像素值相减

29
00:01:58,185 --> 00:02:03,007
在这个例子中 我们要将中间像素与周围像素的值相减

30
00:02:03,007 --> 00:02:06,030
如果这些核值加起来不等于 0

31
00:02:06,030 --> 00:02:08,280
那就意味着计算出来的差

32
00:02:08,280 --> 00:02:10,770
权重会有正负

33
00:02:10,770 --> 00:02:12,960
结果就是滤波后的图像亮度会相应地提高

34
00:02:12,960 --> 00:02:16,629
或降低

35
00:02:16,629 --> 00:02:17,984
要应用这个过滤器

36
00:02:17,985 --> 00:02:21,960
需要把输入图像 F (x , y) 卷进这个核里

37
00:02:21,960 --> 00:02:25,110
我们称其为 k 吧 这就叫核卷积

38
00:02:25,110 --> 00:02:29,340
卷积操作用星号表示

39
00:02:29,340 --> 00:02:31,899
以便与乘号区分开来

40
00:02:31,899 --> 00:02:34,770
核卷积这个操作

41
00:02:34,770 --> 00:02:40,195
对计算机视觉应用十分重要 也是卷积神经网络的基础

42
00:02:40,194 --> 00:02:41,739
核卷积时 我们要取核

43
00:02:41,740 --> 00:02:43,575
也就是取我们的值小网格

44
00:02:43,574 --> 00:02:47,484
并将其逐个传递给图像的各个像素

45
00:02:47,485 --> 00:02:51,585
根据网格内的值来变换图像 稍后我们会看到 改变这些值

46
00:02:51,585 --> 00:02:55,860
就能产生各种各样的效果 从边缘检测到图像模糊都有

47
00:02:55,860 --> 00:03:01,245
以这个三乘三边缘检测过滤器为例

48
00:03:01,245 --> 00:03:03,569
为了更好地观察像素操作

49
00:03:03,569 --> 00:03:08,128
我把这只熊猫的耳朵放大 以便观察其灰度像素值

50
00:03:08,128 --> 00:03:11,849
首先 把核分别放到这张灰度图像的各像素上

51
00:03:11,849 --> 00:03:16,245
分别使各像素位于核的中心

52
00:03:16,245 --> 00:03:19,719
以这个像素为例

53
00:03:19,719 --> 00:03:24,764
我们来看以这个像素为中心的三乘三像素网格

54
00:03:24,764 --> 00:03:27,689
取核中的值

55
00:03:27,689 --> 00:03:31,080
将值与相应的像素值相乘

56
00:03:31,080 --> 00:03:34,254
所以左上角这个像素 120

57
00:03:34,254 --> 00:03:38,799
要乘以核角落的这个 0

58
00:03:38,800 --> 00:03:41,889
然后旁边这个像素值 140 就乘以 -1

59
00:03:41,889 --> 00:03:44,769
接着让 120 乘以 0

60
00:03:44,769 --> 00:03:49,645
对九个像素核值进行同样的处理

61
00:03:49,645 --> 00:03:54,472
注意 值为 220 的中央像素需要乘以 4

62
00:03:54,472 --> 00:03:56,615
也就是核中心的值

63
00:03:56,615 --> 00:04:02,560
最后把这些值加起来 得到新像素值 60

64
00:04:02,560 --> 00:04:05,590
这个值意味着我们检测到了一个很小的边缘

65
00:04:05,590 --> 00:04:09,025
从这个三乘三的图像区域也可以看出这一点

66
00:04:09,025 --> 00:04:13,010
从明亮的底部到较暗的顶部

67
00:04:13,009 --> 00:04:15,354
变化很平缓

68
00:04:15,354 --> 00:04:20,349
核里的这些乘数通常称为权重 因为它们能决定

69
00:04:20,350 --> 00:04:25,700
像素在输出图像的形成过程中有多重要 也即这个像素的分量有多重

70
00:04:25,699 --> 00:04:27,610
在这个例子中 对于边缘检测来说

71
00:04:27,610 --> 00:04:30,520
中央像素是最重要的

72
00:04:30,519 --> 00:04:34,479
其次是在它上下左右的那些相邻像素

73
00:04:34,480 --> 00:04:38,155
这些权重都是负值 会增加图像的对比度

74
00:04:38,154 --> 00:04:42,744
而角落的像素离中心像素最远 在这个例子里

75
00:04:42,745 --> 00:04:44,899
我们不赋予它们任何权重

76
00:04:44,899 --> 00:04:47,230
所以这个权重总和就是

77
00:04:47,230 --> 00:04:53,100
输出图像在同一 x 和 y 坐标上相应像素的值

78
00:04:53,100 --> 00:04:57,610
对原图每个位置的像素都做相同的处理

79
00:04:57,610 --> 00:05:00,655
直到你获得一张完整的输出图像 其大小与输入图像相同

80
00:05:00,654 --> 00:05:05,069
但像素值经过了滤波处理

81
00:05:05,069 --> 00:05:06,865
你唯一需要思考的

82
00:05:06,865 --> 00:05:08,439
除了这个权重总和

83
00:05:08,439 --> 00:05:11,858
就是图像的边缘和角落要怎么处理

84
00:05:11,858 --> 00:05:16,680
因为在那些区域里 核没有办法匹配同样的三乘三像素值

85
00:05:16,680 --> 00:05:19,629
接下来 我们再来做几个高通过滤器练习

86
00:05:19,629 --> 00:05:22,360
然后就开始动手编写代码

