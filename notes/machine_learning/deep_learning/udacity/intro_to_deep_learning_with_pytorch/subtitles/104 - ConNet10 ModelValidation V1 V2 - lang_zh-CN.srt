1
00:00:00,000 --> 00:00:02,970
我们已经根据损失在每个周期的变化情况

2
00:00:02,970 --> 00:00:06,195
检查了模型的表现效果

3
00:00:06,195 --> 00:00:10,065
但是通常很难判断到底要训练多少个周期

4
00:00:10,065 --> 00:00:12,570
才能使模型很准确

5
00:00:12,570 --> 00:00:15,680
并且不会过拟合训练数据

6
00:00:15,680 --> 00:00:19,310
实践中用到的一种方法是

7
00:00:19,310 --> 00:00:23,310
将数据集分成三部分：训练集、验证集和测试集

8
00:00:23,310 --> 00:00:25,670
模型会单独处理每个数据集

9
00:00:25,670 --> 00:00:28,200
模型在训练并判断如何修改权重的过程中

10
00:00:28,200 --> 00:00:31,200
仅查看训练集

11
00:00:31,200 --> 00:00:32,740
每个训练周期之后

12
00:00:32,740 --> 00:00:34,980
我们通过查看训练损失和验证损失

13
00:00:34,980 --> 00:00:37,665
判断模型的表现效果

14
00:00:37,665 --> 00:00:40,575
但是需要注意的是 模型在反向传播过程中

15
00:00:40,575 --> 00:00:44,215
不会使用验证集中的任何数据

16
00:00:44,215 --> 00:00:47,150
我们使用训练集尽可能发现所有规律

17
00:00:47,150 --> 00:00:49,500
并更新和确定模型权重

18
00:00:49,500 --> 00:00:54,330
验证集只是告诉我们模型在验证集上表现是否不错

19
00:00:54,330 --> 00:00:57,350
这样我们就能判断

20
00:00:57,350 --> 00:01:01,185
模型在泛化到训练集之外的数据时效果如何

21
00:01:01,185 --> 00:01:05,780
因为模型在确定权重时没有使用验证集

22
00:01:05,780 --> 00:01:09,035
所以可以告诉我们模型是否过拟合训练集中的数据

23
00:01:09,035 --> 00:01:11,900
训练模型之后

24
00:01:11,900 --> 00:01:14,870
使用测试集检查模型的准确率

25
00:01:14,870 --> 00:01:17,870
举个例子

26
00:01:17,870 --> 00:01:20,810
假设模型训练了 200 个周期

27
00:01:20,810 --> 00:01:22,340
在第 100 个周期左右

28
00:01:22,340 --> 00:01:24,050
训练损失开始下降

29
00:01:24,050 --> 00:01:27,930
但是验证损失开始上升

30
00:01:27,930 --> 00:01:32,240
表明模型过拟合训练数据了

31
00:01:32,240 --> 00:01:36,585
因为它不能足够地泛化并在验证集上也表现很好

32
00:01:36,585 --> 00:01:41,595
如果你看到这种训练损失和验证损失变化情况

33
00:01:41,595 --> 00:01:45,845
需要在第 100 个周期左右停止更改网络权重

34
00:01:45,845 --> 00:01:50,630
并忽略或丢弃后续周期中的权重 因为有证据表明后面开始过拟合了

35
00:01:50,630 --> 00:01:53,390
如果我们有多个潜在结构可以选择

36
00:01:53,390 --> 00:01:56,115
这个流程也很有用

37
00:01:56,115 --> 00:01:59,825
例如 如果你需要决定向模型中添加多少个层级

38
00:01:59,825 --> 00:02:01,625
首先需要保存每个潜在结构的权重

39
00:02:01,625 --> 00:02:04,265
以便稍后加以比较

40
00:02:04,265 --> 00:02:08,105
并选择验证损失最低的模型

41
00:02:08,105 --> 00:02:11,570
你可能会不理解为何要创建第三个数据集？

42
00:02:11,570 --> 00:02:14,310
为何不直接使用测试集？

43
00:02:14,310 --> 00:02:17,305
这是因为在测试模型时

44
00:02:17,305 --> 00:02:20,405
必须使用模型之前从未见过的数据

45
00:02:20,405 --> 00:02:24,220
虽然模型不使用验证集更新权重

46
00:02:24,220 --> 00:02:27,230
但是我们在选择模型时

47
00:02:27,230 --> 00:02:30,565
依据的是模型在训练集和验证集上的表现

48
00:02:30,565 --> 00:02:34,930
所以最终模型会偏向于验证集

49
00:02:34,930 --> 00:02:38,720
我们需要一个单独的测试数据集

50
00:02:38,720 --> 00:02:41,120
才能真正了解所选的模型

51
00:02:41,120 --> 00:02:43,925
在之前确实未见过的数据上泛化效果如何

52
00:02:43,925 --> 00:02:46,010
在下个视频中 我将演示

53
00:02:46,010 --> 00:02:48,750
如何根据这些技巧微调网络结构

