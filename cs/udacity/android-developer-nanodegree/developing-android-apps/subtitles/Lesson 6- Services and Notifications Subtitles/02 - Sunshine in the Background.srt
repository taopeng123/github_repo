0:00:00.140,0:00:03.840
Remember back in lesson two when Katherine used a

0:00:03.840,0:00:07.030
AsyncTask hooked up to a refresh button to update

0:00:07.030,0:00:09.310
our data? Rato talked about how that was a

0:00:09.310,0:00:13.290
bad idea, because the AsyncTask is not tied to

0:00:13.290,0:00:16.610
the activity life cycle. The virtual machine will hold

0:00:16.610,0:00:18.960
on to the activity object as long as the

0:00:18.960,0:00:23.190
AsyncTask is running, even after Android has called onDestroy

0:00:23.190,0:00:26.130
for the activity and expect it to be discarded.

0:00:26.130,0:00:28.380
If you rotate your phone, the behavior is to

0:00:28.380,0:00:31.810
destroy your activity and instantiate a new one. The

0:00:31.810,0:00:35.400
naive AsyncTask implementation now has two threads trying to

0:00:35.400,0:00:39.290
perform the same update, and so forth. The point is,

0:00:39.290,0:00:41.910
it's not the best pattern for a potentially very

0:00:41.910,0:00:45.680
long background operation, such as fetching from web services. If

0:00:45.680,0:00:48.410
you leave the app, the asynctask will continue to

0:00:48.410,0:00:51.340
run for as long as your process is kept alive,

0:00:51.340,0:00:53.750
but will run at a low priority, and your process

0:00:53.750,0:00:55.900
will be the first thing to be killed if the device

0:00:55.900,0:00:59.760
needs more resources. And there's a bigger problem. Your app

0:00:59.760,0:01:02.660
has to be visible and running in the foreground to instantiate

0:01:02.660,0:01:05.590
the task in the first place. Because we started a

0:01:05.590,0:01:09.000
task, to update the weather when we started the app, this

0:01:09.000,0:01:13.070
can have undesirable behavior if the weather changes rapidly. So

0:01:13.070,0:01:16.110
now we're going to learn the right way to perform updates.

0:01:16.110,0:01:18.700
We'll want to automate the process while the app is in

0:01:18.700,0:01:22.690
the foreground. But even more importantly, we want the app to get

0:01:22.690,0:01:26.690
regular updates in the background with minimal battery drain. That will

0:01:26.690,0:01:28.660
be especially important later in this

0:01:28.660,0:01:31.010
lesson when we introduce weather notifications.
